-- View: public.congl_financeiros_geral

-- DROP VIEW public.congl_financeiros_geral;

CREATE OR REPLACE VIEW public.congl_financeiros_geral AS
 SELECT r.nome_if,
    r.co_if,
    r.tp_consolidado_bancario,
    r.tp_controle,
    r.cidade,
    r.uf,
    r.dt_base,
    r.ativo_total,
    r.carteira_credito_classificada,
    r.passivo_circulante_exigivel_longo_prazo,
    r.captacoes,
    r.patrimonio_liquido,
    r.lucro_liquido,
    r.nu_agencias,
    r.nu_postos_atendimento,
    p.depositos_vista,
    p.depositos_prazo,
    p.outros_depositos,
    p.deposito_total,
    p.obrigacoes_operacoes_compromissadas,
    p.letras_credito_imobiliario,
    p.letras_credito_agronegocio,
    p.letras_financeiras,
    p.obrigacoes_titulos_valores_mobiliarios_exterior,
    p.outros_recursos_aceites_emissao_titulos,
    p.recursos_aceites_emissao_titulos,
    p.obrigacoes_emprestimos_repasses,
    p.instrumentos_derivativos,
    p.outras_obrigacoes,
    p.resultado_exercicios_futuros,
    p.passivo_total,
    a.disponibilidades,
    a.aplicacoes_interfinanceiras_liquidez,
    a.tvm_derivativos,
    a.operacoes_credito,
    a.arrendamento_mercantil_receber,
    a.imobilizado_de_arrendamento,
    a.credores_antecipacao_valor_residual,
    a.provisao_sobre_arrendamento_mercantil,
    a.arrendamento_mercantil_liquido_provisao,
    a.outros_creditos_liquidos_provisao,
    a.outros_ativos_realizaveis,
    a.permanente_ajustado,
    a.ativo_total_ajustado,
    dr.rendas_op_credito,
    dr.rendas_op_derivativos,
    dr.resultado_op_cambio,
    dr.rendas_aplicacoes_compulsorias,
    dr.receitas_intermediacao_financeira,
    dr.despesas_captacao,
    dr.despesas_obrigacoes_emprestimos_repasses,
    dr.despesas_operacoes_arrendamento_mercantil,
    dr.resultado_provisao_credito_dificil_liquidacao,
    dr.despesas_intermediacao_financeira,
    dr.resultado_intermediacao_financeira,
    dr.rendas_prestacao_servicos,
    dr.rendas_tarifas_bancarias,
    dr.despesas_administrativas,
    dr.despesas_tributarias,
    dr.resultado_participacoes,
    dr.outras_receitas_operacionais,
    dr.outras_despesas_operacionais,
    dr.outras_receitas_despesas_operacionais,
    dr.resultado_operacional,
    dr.resultado_nao_operacional,
    dr.resultado_antes_tributacao_lucro_participacao,
    dr.imposto_renda_contribuicao_social,
    dr.participacao_lucros,
    dr.juros_sobre_capital_proprio,
    dr.juros_sobre_capital_cooperativas
   FROM congl_financeiros_resumo_import r
     LEFT JOIN congl_financeiros_passivo_import p ON r.co_if = p.co_if AND r.dt_base = p.dt_base
     LEFT JOIN congl_financeiros_ativo_import a ON r.co_if = a.co_if AND r.dt_base = a.dt_base
     LEFT JOIN congl_financeiros_demonstracao_resultado_import dr ON r.co_if = dr.co_if AND r.dt_base = dr.dt_base;

ALTER TABLE public.congl_financeiros_geral
    OWNER TO usr_5482;






-- View: public.ifdata_geral

-- DROP VIEW public.ifdata_geral;

CREATE OR REPLACE VIEW public.ifdata_geral AS
 SELECT congl_financeiros_geral.nome_if,
    congl_financeiros_geral.co_if,
    congl_financeiros_geral.tp_consolidado_bancario,
    congl_financeiros_geral.tp_controle,
    congl_financeiros_geral.cidade,
    congl_financeiros_geral.uf,
    congl_financeiros_geral.dt_base,
    congl_financeiros_geral.ativo_total,
    congl_financeiros_geral.carteira_credito_classificada,
    congl_financeiros_geral.passivo_circulante_exigivel_longo_prazo,
    congl_financeiros_geral.captacoes,
    congl_financeiros_geral.patrimonio_liquido,
    congl_financeiros_geral.lucro_liquido,
    congl_financeiros_geral.nu_agencias,
    congl_financeiros_geral.nu_postos_atendimento,
    congl_financeiros_geral.depositos_vista,
    congl_financeiros_geral.depositos_poupanca,
    congl_financeiros_geral.depositos_interfinanceiros,
    congl_financeiros_geral.depositos_prazo,
    congl_financeiros_geral.outros_depositos,
    congl_financeiros_geral.deposito_total,
    congl_financeiros_geral.obrigacoes_operacoes_compromissadas,
    congl_financeiros_geral.letras_credito_imobiliario,
    congl_financeiros_geral.letras_credito_agronegocio,
    congl_financeiros_geral.letras_financeiras,
    congl_financeiros_geral.obrigacoes_titulos_valores_mobiliarios_exterior,
    congl_financeiros_geral.outros_recursos_aceites_emissao_titulos,
    congl_financeiros_geral.recursos_aceites_emissao_titulos,
    congl_financeiros_geral.obrigacoes_emprestimos_repasses,
    congl_financeiros_geral.instrumentos_derivativos,
    congl_financeiros_geral.outras_obrigacoes,
    congl_financeiros_geral.resultado_exercicios_futuros,
    congl_financeiros_geral.passivo_total,
    congl_financeiros_geral.disponibilidades,
    congl_financeiros_geral.aplicacoes_interfinanceiras_liquidez,
    congl_financeiros_geral.tvm_derivativos,
    congl_financeiros_geral.operacoes_credito,
    congl_financeiros_geral.arrendamento_mercantil_receber,
    congl_financeiros_geral.imobilizado_de_arrendamento,
    congl_financeiros_geral.credores_antecipacao_valor_residual,
    congl_financeiros_geral.provisao_sobre_arrendamento_mercantil,
    congl_financeiros_geral.arrendamento_mercantil_liquido_provisao,
    congl_financeiros_geral.outros_creditos_liquidos_provisao,
    congl_financeiros_geral.outros_ativos_realizaveis,
    congl_financeiros_geral.permanente_ajustado,
    congl_financeiros_geral.ativo_total_ajustado,
    congl_financeiros_geral.rendas_op_credito,
    congl_financeiros_geral.rendas_op_derivativos,
    congl_financeiros_geral.resultado_op_cambio,
    congl_financeiros_geral.rendas_aplicacoes_compulsorias,
    congl_financeiros_geral.receitas_intermediacao_financeira,
    congl_financeiros_geral.despesas_captacao,
    congl_financeiros_geral.despesas_obrigacoes_emprestimos_repasses,
    congl_financeiros_geral.despesas_operacoes_arrendamento_mercantil,
    congl_financeiros_geral.resultado_provisao_credito_dificil_liquidacao,
    congl_financeiros_geral.despesas_intermediacao_financeira,
    congl_financeiros_geral.resultado_intermediacao_financeira,
    congl_financeiros_geral.rendas_prestacao_servicos,
    congl_financeiros_geral.rendas_tarifas_bancarias,
    congl_financeiros_geral.despesas_administrativas,
    congl_financeiros_geral.despesas_tributarias,
    congl_financeiros_geral.resultado_participacoes,
    congl_financeiros_geral.outras_receitas_operacionais,
    congl_financeiros_geral.outras_despesas_operacionais,
    congl_financeiros_geral.outras_receitas_despesas_operacionais,
    congl_financeiros_geral.resultado_operacional,
    congl_financeiros_geral.resultado_nao_operacional,
    congl_financeiros_geral.resultado_antes_tributacao_lucro_participacao,
    congl_financeiros_geral.imposto_renda_contribuicao_social,
    congl_financeiros_geral.participacao_lucros,
    congl_financeiros_geral.juros_sobre_capital_proprio,
    congl_financeiros_geral.juros_sobre_capital_cooperativas
   FROM congl_financeiros_geral
UNION
 SELECT prud_geral.nome_if,
    prud_geral.co_if,
    prud_geral.tp_consolidado_bancario,
    prud_geral.tp_controle,
    prud_geral.cidade,
    prud_geral.uf,
    prud_geral.dt_base,
    prud_geral.ativo_total,
    prud_geral.carteira_credito_classificada,
    prud_geral.passivo_circulante_exigivel_longo_prazo,
    prud_geral.captacoes,
    prud_geral.patrimonio_liquido,
    prud_geral.lucro_liquido,
    prud_geral.nu_agencias,
    prud_geral.nu_postos_atendimento,
    prud_geral.depositos_vista,
    prud_geral.depositos_poupanca,
    prud_geral.depositos_interfinanceiros,
    prud_geral.depositos_prazo,
    prud_geral.outros_depositos,
    prud_geral.deposito_total,
    prud_geral.obrigacoes_operacoes_compromissadas,
    prud_geral.letras_credito_imobiliario,
    prud_geral.letras_credito_agronegocio,
    prud_geral.letras_financeiras,
    prud_geral.obrigacoes_titulos_valores_mobiliarios_exterior,
    prud_geral.outros_recursos_aceites_emissao_titulos,
    prud_geral.recursos_aceites_emissao_titulos,
    prud_geral.obrigacoes_emprestimos_repasses,
    prud_geral.instrumentos_derivativos,
    prud_geral.outras_obrigacoes,
    prud_geral.resultado_exercicios_futuros,
    prud_geral.passivo_total,
    prud_geral.disponibilidades,
    prud_geral.aplicacoes_interfinanceiras_liquidez,
    prud_geral.tvm_derivativos,
    prud_geral.operacoes_credito,
    prud_geral.arrendamento_mercantil_receber,
    prud_geral.imobilizado_de_arrendamento,
    prud_geral.credores_antecipacao_valor_residual,
    prud_geral.provisao_sobre_arrendamento_mercantil,
    prud_geral.arrendamento_mercantil_liquido_provisao,
    prud_geral.outros_creditos_liquidos_provisao,
    prud_geral.outros_ativos_realizaveis,
    prud_geral.permanente_ajustado,
    prud_geral.ativo_total_ajustado,
    prud_geral.rendas_op_credito,
    prud_geral.rendas_op_derivativos,
    prud_geral.resultado_op_cambio,
    prud_geral.rendas_aplicacoes_compulsorias,
    prud_geral.receitas_intermediacao_financeira,
    prud_geral.despesas_captacao,
    prud_geral.despesas_obrigacoes_emprestimos_repasses,
    prud_geral.despesas_operacoes_arrendamento_mercantil,
    prud_geral.resultado_provisao_credito_dificil_liquidacao,
    prud_geral.despesas_intermediacao_financeira,
    prud_geral.resultado_intermediacao_financeira,
    prud_geral.rendas_prestacao_servicos,
    prud_geral.rendas_tarifas_bancarias,
    prud_geral.despesas_administrativas,
    prud_geral.despesas_tributarias,
    prud_geral.resultado_participacoes,
    prud_geral.outras_receitas_operacionais,
    prud_geral.outras_despesas_operacionais,
    prud_geral.outras_receitas_despesas_operacionais,
    prud_geral.resultado_operacional,
    prud_geral.resultado_nao_operacional,
    prud_geral.resultado_antes_tributacao_lucro_participacao,
    prud_geral.imposto_renda_contribuicao_social,
    prud_geral.participacao_lucros,
    prud_geral.juros_sobre_capital_proprio,
    prud_geral.juros_sobre_capital_cooperativas
   FROM prud_geral
UNION
 SELECT inst_individuais_geral.nome_if,
    inst_individuais_geral.co_if,
    inst_individuais_geral.tp_consolidado_bancario,
    inst_individuais_geral.tp_controle,
    inst_individuais_geral.cidade,
    inst_individuais_geral.uf,
    inst_individuais_geral.dt_base,
    inst_individuais_geral.ativo_total,
    inst_individuais_geral.carteira_credito_classificada,
    inst_individuais_geral.passivo_circulante_exigivel_longo_prazo,
    inst_individuais_geral.captacoes,
    inst_individuais_geral.patrimonio_liquido,
    inst_individuais_geral.lucro_liquido,
    inst_individuais_geral.nu_agencias,
    inst_individuais_geral.nu_postos_atendimento,
    inst_individuais_geral.depositos_vista,
    inst_individuais_geral.depositos_poupanca,
    inst_individuais_geral.depositos_interfinanceiros,
    inst_individuais_geral.depositos_prazo,
    inst_individuais_geral.outros_depositos,
    inst_individuais_geral.deposito_total,
    inst_individuais_geral.obrigacoes_operacoes_compromissadas,
    inst_individuais_geral.letras_credito_imobiliario,
    inst_individuais_geral.letras_credito_agronegocio,
    inst_individuais_geral.letras_financeiras,
    inst_individuais_geral.obrigacoes_titulos_valores_mobiliarios_exterior,
    inst_individuais_geral.outros_recursos_aceites_emissao_titulos,
    inst_individuais_geral.recursos_aceites_emissao_titulos,
    inst_individuais_geral.obrigacoes_emprestimos_repasses,
    inst_individuais_geral.instrumentos_derivativos,
    inst_individuais_geral.outras_obrigacoes,
    inst_individuais_geral.resultado_exercicios_futuros,
    inst_individuais_geral.passivo_total,
    inst_individuais_geral.disponibilidades,
    inst_individuais_geral.aplicacoes_interfinanceiras_liquidez,
    inst_individuais_geral.tvm_derivativos,
    inst_individuais_geral.operacoes_credito,
    inst_individuais_geral.arrendamento_mercantil_receber,
    inst_individuais_geral.imobilizado_de_arrendamento,
    inst_individuais_geral.credores_antecipacao_valor_residual,
    inst_individuais_geral.provisao_sobre_arrendamento_mercantil,
    inst_individuais_geral.arrendamento_mercantil_liquido_provisao,
    inst_individuais_geral.outros_creditos_liquidos_provisao,
    inst_individuais_geral.outros_ativos_realizaveis,
    inst_individuais_geral.permanente_ajustado,
    inst_individuais_geral.ativo_total_ajustado,
    inst_individuais_geral.rendas_op_credito,
    inst_individuais_geral.rendas_op_derivativos,
    inst_individuais_geral.resultado_op_cambio,
    inst_individuais_geral.rendas_aplicacoes_compulsorias,
    inst_individuais_geral.receitas_intermediacao_financeira,
    inst_individuais_geral.despesas_captacao,
    inst_individuais_geral.despesas_obrigacoes_emprestimos_repasses,
    inst_individuais_geral.despesas_operacoes_arrendamento_mercantil,
    inst_individuais_geral.resultado_provisao_credito_dificil_liquidacao,
    inst_individuais_geral.despesas_intermediacao_financeira,
    inst_individuais_geral.resultado_intermediacao_financeira,
    inst_individuais_geral.rendas_prestacao_servicos,
    inst_individuais_geral.rendas_tarifas_bancarias,
    inst_individuais_geral.despesas_administrativas,
    inst_individuais_geral.despesas_tributarias,
    inst_individuais_geral.resultado_participacoes,
    inst_individuais_geral.outras_receitas_operacionais,
    inst_individuais_geral.outras_despesas_operacionais,
    inst_individuais_geral.outras_receitas_despesas_operacionais,
    inst_individuais_geral.resultado_operacional,
    inst_individuais_geral.resultado_nao_operacional,
    inst_individuais_geral.resultado_antes_tributacao_lucro_participacao,
    inst_individuais_geral.imposto_renda_contribuicao_social,
    inst_individuais_geral.participacao_lucros,
    inst_individuais_geral.juros_sobre_capital_proprio,
    inst_individuais_geral.juros_sobre_capital_cooperativas
   FROM inst_individuais_geral;

ALTER TABLE public.ifdata_geral
    OWNER TO usr_5482;




-- View: public.inst_individuais_geral

-- DROP VIEW public.inst_individuais_geral;

CREATE OR REPLACE VIEW public.inst_individuais_geral AS
 SELECT r.nome_if,
    r.co_if,
    r.tp_consolidado_bancario,
    r.tp_controle,
    r.cidade,
    r.uf,
    r.dt_base,
    r.ativo_total,
    r.carteira_credito_classificada,
    r.passivo_circulante_exigivel_longo_prazo,
    r.captacoes,
    r.patrimonio_liquido,
    r.lucro_liquido,
    r.nu_agencias,
    r.nu_postos_atendimento,
    p.depositos_vista,
    p.depositos_poupanca,
    p.depositos_interfinanceiros,
    p.depositos_prazo,
    p.outros_depositos,
    p.deposito_total,
    p.obrigacoes_operacoes_compromissadas,
    p.letras_credito_imobiliario,
    p.letras_credito_agronegocio,
    p.letras_financeiras,
    p.obrigacoes_titulos_valores_mobiliarios_exterior,
    p.outros_recursos_aceites_emissao_titulos,
    p.recursos_aceites_emissao_titulos,
    p.obrigacoes_emprestimos_repasses,
    p.instrumentos_derivativos,
    p.outras_obrigacoes,
    p.resultado_exercicios_futuros,
    p.passivo_total,
    a.disponibilidades,
    a.aplicacoes_interfinanceiras_liquidez,
    a.tvm_derivativos,
    a.operacoes_credito,
    a.arrendamento_mercantil_receber,
    a.imobilizado_de_arrendamento,
    a.credores_antecipacao_valor_residual,
    a.provisao_sobre_arrendamento_mercantil,
    a.arrendamento_mercantil_liquido_provisao,
    a.outros_creditos_liquidos_provisao,
    a.outros_ativos_realizaveis,
    a.permanente_ajustado,
    a.ativo_total_ajustado,
    dr.rendas_op_credito,
    dr.rendas_op_derivativos,
    dr.resultado_op_cambio,
    dr.rendas_aplicacoes_compulsorias,
    dr.receitas_intermediacao_financeira,
    dr.despesas_captacao,
    dr.despesas_obrigacoes_emprestimos_repasses,
    dr.despesas_operacoes_arrendamento_mercantil,
    dr.resultado_provisao_credito_dificil_liquidacao,
    dr.despesas_intermediacao_financeira,
    dr.resultado_intermediacao_financeira,
    dr.rendas_prestacao_servicos,
    dr.rendas_tarifas_bancarias,
    dr.despesas_administrativas,
    dr.despesas_tributarias,
    dr.resultado_participacoes,
    dr.outras_receitas_operacionais,
    dr.outras_despesas_operacionais,
    dr.outras_receitas_despesas_operacionais,
    dr.resultado_operacional,
    dr.resultado_nao_operacional,
    dr.resultado_antes_tributacao_lucro_participacao,
    dr.imposto_renda_contribuicao_social,
    dr.participacao_lucros,
    dr.juros_sobre_capital_proprio,
    dr.juros_sobre_capital_cooperativas
   FROM inst_individuais_resumo_import r
     LEFT JOIN inst_individuais_passivo_import p ON r.co_if = p.co_if AND r.dt_base = p.dt_base
     LEFT JOIN inst_individuais_ativo_import a ON r.co_if = a.co_if AND r.dt_base = a.dt_base
     LEFT JOIN inst_individuais_demonstracao_resultado_import dr ON r.co_if = dr.co_if AND r.dt_base = dr.dt_base;

ALTER TABLE public.inst_individuais_geral
    OWNER TO usr_5482;




-- View: public.prud_geral

-- DROP VIEW public.prud_geral;

CREATE OR REPLACE VIEW public.prud_geral AS
 SELECT r.nome_if,
    r.co_if,
    r.tp_consolidado_bancario,
    r.segmento,
    r.tp_consolidacao,
    r.tp_controle,
    r.cidade,
    r.uf,
    r.dt_base,
    r.ativo_total,
    r.carteira_credito_classificada,
    r.passivo_circulante_exigivel_longo_prazo,
    r.captacoes,
    r.patrimonio_liquido,
    r.lucro_liquido,
    r.patrimonio_referencia,
    r.ic_basileia,
    r.ic_imobilizacao,
    r.nu_agencias,
    r.nu_postos_atendimento,
    p.depositos_vista,
    p.depositos_poupanca,
    p.depositos_interfinanceiros,
    p.depositos_prazo,
    p.outros_depositos,
    p.deposito_total,
    p.obrigacoes_operacoes_compromissadas,
    p.letras_credito_imobiliario,
    p.letras_credito_agronegocio,
    p.letras_financeiras,
    p.obrigacoes_titulos_valores_mobiliarios_exterior,
    p.outros_recursos_aceites_emissao_titulos,
    p.recursos_aceites_emissao_titulos,
    p.obrigacoes_emprestimos_repasses,
    p.instrumentos_derivativos,
    p.outras_obrigacoes,
    p.resultado_exercicios_futuros,
    p.passivo_total,
    a.disponibilidades,
    a.aplicacoes_interfinanceiras_liquidez,
    a.tvm_derivativos,
    a.operacoes_credito,
    a.provisao_operacoes_credito,
    a.operacoes_credito_liquidas_provisao,
    a.arrendamento_mercantil_receber,
    a.imobilizado_de_arrendamento,
    a.credores_antecipacao_valor_residual,
    a.provisao_sobre_arrendamento_mercantil,
    a.arrendamento_mercantil_liquido_provisao,
    a.outros_creditos_liquidos_provisao,
    a.outros_ativos_realizaveis,
    a.permanente_ajustado,
    a.ativo_total_ajustado,
    dr.rendas_op_credito,
    dr.rendas_op_arrendamento_mercantil,
    dr.rendas_op_tvm,
    dr.rendas_op_derivativos,
    dr.resultado_op_cambio,
    dr.rendas_aplicacoes_compulsorias,
    dr.receitas_intermediacao_financeira,
    dr.despesas_captacao,
    dr.despesas_obrigacoes_emprestimos_repasses,
    dr.despesas_operacoes_arrendamento_mercantil,
    dr.resultado_provisao_credito_dificil_liquidacao,
    dr.despesas_intermediacao_financeira,
    dr.resultado_intermediacao_financeira,
    dr.rendas_prestacao_servicos,
    dr.rendas_tarifas_bancarias,
    dr.despesas_pessoal,
    dr.despesas_administrativas,
    dr.despesas_tributarias,
    dr.resultado_participacoes,
    dr.outras_receitas_operacionais,
    dr.outras_despesas_operacionais,
    dr.outras_receitas_despesas_operacionais,
    dr.resultado_operacional,
    dr.resultado_nao_operacional,
    dr.resultado_antes_tributacao_lucro_participacao,
    dr.imposto_renda_contribuicao_social,
    dr.participacao_lucros,
    dr.juros_sobre_capital_proprio,
    dr.juros_sobre_capital_cooperativas,
    ic.capital_principal,
    ic.capital_complementar,
    ic.patrimonio_referencia_nivel_1,
    ic.capital_nivel_2,
    ic.rwa_risco_credito,
    ic.rwa_cam,
    ic.rwa_com,
    ic.rwa_jur,
    ic.rwa_acs,
    ic.rwa_risco_mercado,
    ic.rwa_risco_operacional,
    ic.rwa_ativos_ponderados_risco,
    ic.ic_capital_principal,
    ic.ic_capital_nivel_1,
    ic.razao_alavancagem,
    s.ic_apuracao_exposicao_total,
    s.ic_apuracao_patrimonio_referencia,
    s.ic_metodologia_simplificada,
    s.total_ativos_consolidado_exterior,
    s.dt_ultima_alteracao_segmento
   FROM prud_resumo_import r
     LEFT JOIN prud_passivo_import p ON r.co_if = p.co_if AND r.dt_base = p.dt_base
     LEFT JOIN prud_ativo_import a ON r.co_if = a.co_if AND r.dt_base = a.dt_base
     LEFT JOIN prud_demonstracao_resultado_import dr ON r.co_if = dr.co_if AND r.dt_base = dr.dt_base
     LEFT JOIN prud_informacoes_capital_import ic ON r.co_if = ic.co_if AND r.dt_base = ic.dt_base
     LEFT JOIN prud_segmentacao_import s ON r.co_if = s.co_if AND r.dt_base = s.dt_base;

ALTER TABLE public.prud_geral
    OWNER TO usr_5482;
